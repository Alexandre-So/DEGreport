<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find correlation between pcs and covariates — degCovariates • DEGreport</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Find correlation between pcs and covariates — degCovariates" />

<meta property="og:description" content="This function will calculate the pcs using prcomp function,
and correlate categorical and numerical variables from
metadata. The size of the dots indicates the importance of the
metadata, for instance, when the range of the values is pretty
small (from 0.001 to 0.002 in ribosimal content),
the correlation results is not important. See details to know
how this is calculated." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DEGreport</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.17.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/DEGreport.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find correlation between pcs and covariates</h1>
    
    <div class="hidden name"><code>degCovariates.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function will calculate the pcs using prcomp function,
and correlate categorical and numerical variables from
metadata. The size of the dots indicates the importance of the
metadata, for instance, when the range of the values is pretty
small (from 0.001 to 0.002 in ribosimal content),
the correlation results is not important. See details to know
how this is calculated.</p>
    
    </div>

    <pre class="usage"><span class='fu'>degCovariates</span>(<span class='no'>counts</span>, <span class='no'>metadata</span>, <span class='kw'>fdr</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>minPC</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>correlation</span> <span class='kw'>=</span> <span class='st'>"kendall"</span>, <span class='kw'>addCovDen</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>legacy</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>smart</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>counts</th>
      <td><p>normalized counts matrix</p></td>
    </tr>
    <tr>
      <th>metadata</th>
      <td><p>data.frame with samples metadata.</p></td>
    </tr>
    <tr>
      <th>fdr</th>
      <td><p>numeric value to use as cutoff to determine
the minimum fdr to consider significant correlations
between pcs and covariates.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>boolean to determine wether counts matrix should be
scaled for pca. default FALSE.</p></td>
    </tr>
    <tr>
      <th>minPC</th>
      <td><p>numeric value that will be used as cutoff
to select only pcs that explain more variability than this.</p></td>
    </tr>
    <tr>
      <th>correlation</th>
      <td><p>character determining the method for the
correlation between pcs and covariates.</p></td>
    </tr>
    <tr>
      <th>addCovDen</th>
      <td><p>boolean. Whether to add the covariates
dendograme to the plot to see covariates relationship.
It will show <code><a href='degCorCov.html'>degCorCov()</a></code> dendograme on top of the columns of
the heatmap.</p></td>
    </tr>
    <tr>
      <th>legacy</th>
      <td><p>boolean. Whether to plot the legacy version.</p></td>
    </tr>
    <tr>
      <th>smart</th>
      <td><p>boolean. Whether to avoid normalization of the
numeric covariates when calculating importance. This is not
used if <code>legacy = TRUE</code>. See @details for more information.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Whether to plot or not the correlation matrix.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>: list:
a) plot, heatmap of the correlation found. * means pvalue &lt; 0.05.
Only variables with FDR value lower than the cutoff are colored.
b) corMatrix, correlation, p-value, FDR values
for each covariate and PCA pais
c) pcsMatrix: PCs loading for each sample
d) scatterPlot: plot for each significant covariate and
the PC values.
e) significants: contains the significant covariates
using a linear model to predict the coefficient
of covariates that have some color in the plot.
All the significant covariates from the liner model analysis
are returned.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This method is adapeted from Daily et al 2017 article.
Principal components from PCA analysis are correlated with
covariates metadata. Factors are transformed to numeric variables.
Correlation is measured by <code>cor.test</code> function with Kendall method
by default.</p>
<p>The size of the dot, or importance, indicates the importance of
the covariate based on the range of the values. Covariates
where the range is very small (like a <!-- % of mapped reads that -->
varies between 0.001 to 0.002) will have a very small size (0.1*max_size).
The maximum value is set to 5 units.
To get to importance, each covariate is normalized using this
equation: <code>1 - min(v/max(v))</code>,
and the minimum and maximum values are set to
0.01 and 1 respectively. For instance, 0.5 would mean there is at least
50<!-- % of difference between the minimum value and the maximum value. -->
Categorical variables are plot using the maximum size always, since
it is not possible to estimate the variability. By default, it
won't do <code>v/max(v)</code> if the values are already between 0-1 or
0-100 (already normalized values as rates and percentages).
If you want to ignore the importance, use <code>legacy = TRUE</code>.</p>
<p>Finally, a linear model is used to calculate the significance
of the covariates effect on the PCs. For that, this function
uses <code>lm</code> to refress the data and uses the p-value calculated by
each variable in the model to define significance (pvalue &lt; 0.05).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Daily, K. et al.  Molecular, phenotypic, and sample-associated data to describe pluripotent stem cell lines and derivatives. Sci Data 4, 170030 (2017).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>humanGender</span>)
<span class='fu'>library</span>(<span class='no'>DESeq2</span>)
<span class='no'>idx</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='fl'>75</span>:<span class='fl'>85</span>)
<span class='no'>dse</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/DESeq2/topics/DESeqDataSet'>DESeqDataSetFromMatrix</a></span>(<span class='fu'>assays</span>(<span class='no'>humanGender</span>)<span class='kw'>[[</span><span class='fl'>1</span>]][<span class='fl'>1</span>:<span class='fl'>1000</span>, <span class='no'>idx</span>],
  <span class='fu'>colData</span>(<span class='no'>humanGender</span>)[<span class='no'>idx</span>,], <span class='kw'>design</span><span class='kw'>=</span>~<span class='no'>group</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>degCovariates</span>(<span class='fu'>log2</span>(<span class='fu'><a href='http://www.rdocumentation.org/packages/DESeq2/topics/counts'>counts</a></span>(<span class='no'>dse</span>)+<span class='fl'>0.5</span>), <span class='fu'>colData</span>(<span class='no'>dse</span>))</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>running pca and calculating correlations for:</span>
#&gt; <span class='message'>un-scaled  data in pca;</span>
#&gt; <span class='message'>pve &gt;= 5%;</span>
#&gt; <span class='message'>kendall cor </span></div><div class='img'><img src='degCovariates-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>degCovariates</span>(<span class='fu'>log2</span>(<span class='fu'><a href='http://www.rdocumentation.org/packages/DESeq2/topics/counts'>counts</a></span>(<span class='no'>dse</span>)+<span class='fl'>0.5</span>),
  <span class='fu'>colData</span>(<span class='no'>dse</span>), <span class='kw'>legacy</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>running pca and calculating correlations for:</span>
#&gt; <span class='message'>un-scaled  data in pca;</span>
#&gt; <span class='message'>pve &gt;= 5%;</span>
#&gt; <span class='message'>kendall cor </span></div><div class='img'><img src='degCovariates-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>res</span>$<span class='no'>plot</span></div><div class='img'><img src='degCovariates-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>res</span>$<span class='no'>scatterPlot</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='img'><img src='degCovariates-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
: Lorena Pantano, Victor Barrera,
Kenneth Daily and Thanneer Malai Perumal

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://lpantano.github.io'>Lorena Pantano</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

